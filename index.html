<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>GitHub page as PWA template</title>
  <link rel="manifest" href="/github-page-pwa/manifest.webmanifest">
  <link rel="stylesheet" href="css/styles.css">
</head>
<body>
  <nav class="theme-switch-wrapper">
  <em>Th√®me :</em>
    <label for="themecheck" class="theme-switch">
      <input type="checkbox" id="themecheck"/>
      <div class="slider round"></div>
    </label>
</nav>
  <h1>GitHub page as PWA template</h1>
  <p>
    This is a PWA template for GitHub pages. 
    Make sure to check the README at 
    <a href="https://github.com/codepo8/github-page-pwa/">https://github.com/codepo8/github-page-pwa/</a> and 
    to change the necessary settings to your needs.
  </p>
  <a href="#" class="install-link">Installer l'app</a>

    <script src="./installer.js"></script>
  <script>
      if (navigator.serviceWorker) {
        navigator.serviceWorker.register (
          '/github-page-pwa/sw.js',
          {scope: '/github-page-pwa/'}
        )
      }
  </script>
  <script>
    const switchBtn = document.querySelector('#themecheck')
const defaultTheme = window.matchMedia("(prefers-color-scheme :dark)");
let currentTheme = localStorage.getItem('theme')
switchBtn.addEventListener('change', switchTheme)

if (defaultTheme.matches) {
    if (currentTheme === 'light') {
        document.documentElement.setAttribute('data-theme', 'light');
        document.querySelector('meta[name="theme-color"]').setAttribute("content", "#eeeeee");
        switchBtn.checked = false;
    } else if (currentTheme === 'dark') {
        document.documentElement.setAttribute('data-theme', 'dark');
        document.querySelector('meta[name="theme-color"]').setAttribute("content", "#000000");
        switchBtn.checked = true;
    }

} else {
    if (currentTheme === 'light') {
        document.documentElement.setAttribute('data-theme', 'light');
        document.querySelector('meta[name="theme-color"]').setAttribute("content", "#eeeeee");
        switchBtn.checked = false;
    } else if (currentTheme === 'dark') {
        document.documentElement.setAttribute('data-theme', 'dark');
        document.querySelector('meta[name="theme-color"]').setAttribute("content", "#000000");
        switchBtn.checked = true;
    }
}

function switchTheme(e) {
    if (e.target.checked) {
        document.documentElement.setAttribute('data-theme', 'dark')
        document.querySelector('meta[name="theme-color"]').setAttribute("content", "#000000");
        localStorage.setItem('theme', 'dark')
        console.log(localStorage.getItem('theme'));
    } else {
        document.documentElement.setAttribute('data-theme', 'light')
        document.querySelector('meta[name="theme-color"]').setAttribute("content", "#eeeeee");
        localStorage.setItem('theme', 'light')
        console.log(localStorage.getItem('theme'));
    }
}
  </script>
</body>
</html>
